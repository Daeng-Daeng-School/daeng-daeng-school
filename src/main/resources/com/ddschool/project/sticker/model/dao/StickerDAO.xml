<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "https://mybatis.org/dtd/mybatis-3-mapper.dtd">
  
<mapper namespace="com.ddschool.project.sticker.model.dao.StickerDAO">

   <resultMap type="com.ddschool.project.sticker.model.dto.StickerDTO" id="stickerListResultMap">
   <!--  property=DTO, column=db -->
      <id property="stickerCode" column="STICKER_CODE"/>
      <result property="dogCode" column="DOG_NAME"/>
      <result property="memberCode" column="MEMBER_NAME"/>
      <result property="stickerNum" column="STICKER_NUM"/>
      <result property="comment" column="COMMENT"/>
      <result property="registDate" column="REGIST_DATE"/>   
            
   </resultMap>   
   
       			

   <insert id="insertSticker" parameterType="com.ddschool.project.sticker.model.dto.StickerDTO">
   INSERT INTO 
         TBL_STICKER(
                  DOG_CODE
                  , MEMBER_CODE
                  , STICKER_NUM
                  , COMMENT
                  , REGIST_DATE
                  )
         VALUES (
               #{ dogCode }
               , #{ memberCode }
               , #{ stickerNum }
               , #{ comment }
               , #{ registDate }               
               
               )
   </insert>
   
    <update id="updateSticker" parameterType="com.ddschool.project.sticker.model.dto.StickerDTO">
  	 UPDATE  TBL_STICKER
  	 SET
                  DOG_CODE = #{ dogCode }                  
                  , MEMBER_CODE = #{ memberCode }
                  , STICKER_NUM = #{ stickerNum }
                  , COMMENT = #{ comment }
                  , REGIST_DATE = #{ registDate }   
     WHERE STICKER_CODE = #{ stickerCode }
                                 
         
   </update>
   
   <delete id="deleteSticker" parameterType="com.ddschool.project.sticker.model.dto.StickerDTO">
  	 DELETE FROM TBL_STICKER
  	 WHERE STICKER_CODE = #{ stickerCode }
                                 
         
   </delete>
   
   
   
   <select id="selectListSticker" parameterType="com.ddschool.project.sticker.model.dto.StickerDTO" resultMap="stickerListResultMap">
 		SELECT A.STICKER_CODE
      			, B.DOG_NAME
      			, C.MEMBER_NAME
      			, A.STICKER_NUM
      			, A.COMMENT
      			, A.REGIST_DATE
		FROM TBL_STICKER A
		JOIN TBL_DOG B ON (A.DOG_CODE = B.DOG_CODE)
		JOIN TBL_MEMBER C ON (A.MEMBER_CODE = C.MEMBER_CODE)
		WHERE DATE_FORMAT(A.REGIST_DATE, '%Y%m')=#{registDate};
                                 
         
   </select>

</mapper>